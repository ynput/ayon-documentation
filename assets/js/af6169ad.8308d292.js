"use strict";(self.webpackChunkayon_docs=self.webpackChunkayon_docs||[]).push([[758],{4137:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,d=a(e,["components","mdxType","originalType","parentName"]),u=c(n),h=i,f=u["".concat(l,".").concat(h)]||u[h]||p[h]||o;return n?r.createElement(f,s(s({ref:t},d),{},{components:n})):r.createElement(f,s({ref:t},d))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=h;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[u]="string"==typeof e?e:i,s[1]=a;for(var c=2;c<o;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},2646:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var r=n(7462),i=(n(7294),n(4137));const o={id:"server_testing",title:"Testing AYON Server",sidebar_label:"Testing"},s="Frontend E2E tests",a={unversionedId:"server_testing",id:"server_testing",title:"Testing AYON Server",description:"Frontend E2E testing strategy is still under debate, current tests and their implementation details may change significantly in the near future.",source:"@site/docs/server_testing.md",sourceDirName:".",slug:"/server_testing",permalink:"/ayon-documentation/docs/server_testing",draft:!1,editUrl:"https://github.com/ynput/ayon-documentation/tree/main/website/docs/server_testing.md",tags:[],version:"current",frontMatter:{id:"server_testing",title:"Testing AYON Server",sidebar_label:"Testing"},sidebar:"Dev",previous:{title:"Theme",permalink:"/ayon-documentation/docs/server_theme"},next:{title:"Developer mode",permalink:"/ayon-documentation/docs/dev_dev_mode"}},l={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Setting up and running tests",id:"setting-up-and-running-tests",level:2},{value:"How to add new tests",id:"how-to-add-new-tests",level:2},{value:"Spec files",id:"spec-files",level:3},{value:"Fixture files",id:"fixture-files",level:3},{value:"Test Isolation",id:"test-isolation",level:3},{value:"Tests cleanup",id:"tests-cleanup",level:3},{value:"Generate tests on the fly",id:"generate-tests-on-the-fly",level:2}],d={toc:c},u="wrapper";function p(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"frontend-e2e-tests"},"Frontend E2E tests"),(0,i.kt)("admonition",{title:"Work In Progress",type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Frontend E2E testing strategy is still under debate, current tests and their implementation details may change significantly in the near future.")),(0,i.kt)("h2",{id:"introduction"},"Introduction"),(0,i.kt)("p",null,"End-to-end testing is a crucial part of the software development lifecycle, ensuring applications work as expected. We've embarked on the process of implementing E2E tests for AYON Server, our ultimate goal being the complete test coverage and consistent positive results across the multiple supported browsers."),(0,i.kt)("h2",{id:"setting-up-and-running-tests"},"Setting up and running tests"),(0,i.kt)("p",null,"For the frontend E2E tests we're using ",(0,i.kt)("a",{parentName:"p",href:"https://playwright.dev"},"Playwright")," which proves to be useful and easy to use toolset for developers and even less technical users. In order to run tests locally you will need to install playwright and follow the installation instructions (defaults are safe choices):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"yarn create playwright\n")),(0,i.kt)("p",null,"You'll also need to update your local ENV file by adding the following required variables (URLS & ports may vary for each setup):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"LOCAL_SERVER_URL=http://localhost:3000\nTEST_SERVER_URL=https://localhost:5000\nNAME=admin #authentication user\nPASSWORD=pass #authentication password\n")),(0,i.kt)("p",null,"Once installed you can run the existing tests either using the console - ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn test")," - or the test UI if you prefer so - ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn test-ui")),(0,i.kt)("h2",{id:"how-to-add-new-tests"},"How to add new tests"),(0,i.kt)("p",null,"In order to add new tests of update existing ones we recommend following the existing files structure found in the ",(0,i.kt)("inlineCode",{parentName:"p"},"tests")," folder."),(0,i.kt)("h3",{id:"spec-files"},"Spec files"),(0,i.kt)("p",null,"Tests are grouped by entity type, i.e. project level tests are written in the projects.spec.js, folders level tests in the folders.spec.js file and so on."),(0,i.kt)("h3",{id:"fixture-files"},"Fixture files"),(0,i.kt)("p",null,"Most tests will need parent entities to be created - i.e. a folder can't exist outside a project. To ease test creation, we're using ",(0,i.kt)("em",{parentName:"p"},"fixtures")," helpers. These allow you to easily create and destroy required entities with one-line calls, so you can focus on the task at hand."),(0,i.kt)("h3",{id:"test-isolation"},"Test Isolation"),(0,i.kt)("p",null,"Current configuration runs the tests in parallel, which might cause issues if specs are not properly written. In order to avoid any race issues, we recommend to follow a safe entity naming strategy, i.e. prefix entity names with unique identifiers (see existing tests for examples)."),(0,i.kt)("h3",{id:"tests-cleanup"},"Tests cleanup"),(0,i.kt)("p",null,"Testing entities that depend on others will require the creation of parent entities. Make sure that they are properly destroyed after testing is done to avoid pollution of future test runs. For example, when testing folders or tasks, the easiest cleanup method would be to delete the parent project, which will, in turn, delete all the related records."),(0,i.kt)("h2",{id:"generate-tests-on-the-fly"},"Generate tests on the fly"),(0,i.kt)("p",null,"As mentioned previously we chose ",(0,i.kt)("a",{parentName:"p",href:"https://playwright.dev"},"Playwright")," for its versatility and ease of use."),(0,i.kt)("p",null,"One powerful tool that comes with it is code generation mode, which can translate a point and click interaction to actual spec statements, be it selecting specific UI elements, or making assertions."),(0,i.kt)("p",null,"In order to use the code generation tool run ",(0,i.kt)("inlineCode",{parentName:"p"},"yarn test-codegen")," which will run playwright in codegeneration mode. Once started, just interact with the embedded browser window while keeping an eye on the secondary window. All interactions will be recorded in the secondary window, you can quickly generate the basis of your test, which can be then copied over to the actual spec file - see the example below:"),(0,i.kt)("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/O-uS5wKKB30?si=9ikavCUIMXzhNmjA",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",referrerpolicy:"strict-origin-when-cross-origin",allowfullscreen:!0}))}p.isMDXComponent=!0}}]);