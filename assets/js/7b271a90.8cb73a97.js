"use strict";(self.webpackChunkayon_docs=self.webpackChunkayon_docs||[]).push([[196],{4137:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=d(n),u=i,h=c["".concat(l,".").concat(u)]||c[u]||m[u]||r;return n?a.createElement(h,o(o({ref:t},p),{},{components:n})):a.createElement(h,o({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:i,o[1]=s;for(var d=2;d<r;d++)o[d]=n[d];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},3234:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=n(7462),i=(n(7294),n(4137));const r={id:"dev_publishing",title:"Publishing",sidebar_label:"Publishing",toc_max_heading_level:4},o=void 0,s={unversionedId:"dev_publishing",id:"dev_publishing",title:"Publishing",description:"Publishing workflow consists of 2 parts:",source:"@site/docs/dev_publishing.md",sourceDirName:".",slug:"/dev_publishing",permalink:"/docs/dev_publishing",draft:!1,editUrl:"https://github.com/ynput/ayon-documentation/tree/main/website/docs/dev_publishing.md",tags:[],version:"current",frontMatter:{id:"dev_publishing",title:"Publishing",sidebar_label:"Publishing",toc_max_heading_level:4},sidebar:"Dev",previous:{title:"Host implementation",permalink:"/docs/dev_host_implementation"},next:{title:"Deadline integration",permalink:"/docs/dev_deadline"}},l={},d=[{value:"<strong>Creating</strong>",id:"creating",level:2},{value:"Created instance",id:"created-instance",level:3},{value:"<em>Create context</em>",id:"category-doc-link",level:4},{value:"Required functions in host implementation",id:"required-functions-in-host-implementation",level:4},{value:"Create plugin",id:"create-plugin",level:3},{value:"<em>BaseCreator</em>",id:"basecreator",level:4},{value:"<em>HiddenCreator</em>",id:"hiddencreator",level:4},{value:"<em>AutoCreator</em>",id:"autocreator",level:4},{value:"<em>Creator</em>",id:"creator",level:4},{value:"<strong>Publish</strong>",id:"publish",level:2},{value:"Exceptions",id:"exceptions",level:3},{value:"<em>Validation exception</em>",id:"validation-exception",level:4},{value:"<em>Known errors</em>",id:"known-errors",level:4},{value:"Plugin extension",id:"plugin-extension",level:3},{value:"<strong>UI examples</strong>",id:"ui-examples",level:2},{value:"Main publish window",id:"main-publish-window",level:3},{value:"<em>Instances views</em>",id:"instances-views",level:4},{value:"<em>Context options</em>",id:"context-options",level:4},{value:"<em>Create attributes</em>",id:"create-attributes",level:4},{value:"<em>Publish attributes</em>",id:"publish-attributes",level:4},{value:"Create dialog",id:"create-dialog",level:3}],p={toc:d},c="wrapper";function m(e){let{components:t,...r}=e;return(0,i.kt)(c,(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Publishing workflow consists of 2 parts:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Creating - Mark what will be published and how."),(0,i.kt)("li",{parentName:"ul"},"Publishing - Use data from Creating to go through the pyblish process.")),(0,i.kt)("p",null,"AYON is using ",(0,i.kt)("a",{parentName:"p",href:"https://pyblish.com/"},"pyblish")," for the publishing process. AYON extends and modifies its few functions a bit, mainly for reports and UI purposes. The main differences are that AYON's publish UI allows to enable/disable instances or plugins during Creating part instead of in the publishing part and has limited plugin actions only for failed validation plugins."),(0,i.kt)("h2",{id:"creating"},(0,i.kt)("strong",{parentName:"h2"},"Creating")),(0,i.kt)("p",null,'Concept of Creating does not have to "create" anything yet, but prepare and store metadata about an "instance" (becomes a product after the publish process). Created instance always has ',(0,i.kt)("inlineCode",{parentName:"p"},"family")," which defines what kind of data will be published, the best example is ",(0,i.kt)("inlineCode",{parentName:"p"},"workfile")," family. Storing of metadata is host specific and may be even a Creator plugin specific. Most hosts are storing metadata into a workfile (Maya scene, Nuke script, etc.) to an item or a node the same way as regular Pyblish instances, so consistency of host implementation is kept, but some features may require a different approach that is the reason why it is creator plugin responsibility. Storing the metadata to the workfile persists values, so the artist does not have to create and set what should be published and how over and over."),(0,i.kt)("h3",{id:"created-instance"},"Created instance"),(0,i.kt)("p",null,"Objected representation of created instance metadata defined by class ",(0,i.kt)("strong",{parentName:"p"},"CreatedInstance"),". Has access to ",(0,i.kt)("strong",{parentName:"p"},"CreateContext")," and ",(0,i.kt)("strong",{parentName:"p"},"BaseCreator")," that initialized the object. Is a dictionary-like object with few immutable keys (marked with start ",(0,i.kt)("inlineCode",{parentName:"p"},"*")," in table). The immutable keys are set by the creator plugin or create context on initialization and their values can't change. Instance can have more arbitrary data, for example ids of nodes in scene but keep in mind that some keys are reserved."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Key"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*id"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Identifier of metadata type. ATM constant ",(0,i.kt)("strong",{parentName:"td"},'"pyblish.avalon.instance"'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*instance_id"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Unique ID of instance. Set automatically on instance creation using ",(0,i.kt)("inlineCode",{parentName:"td"},"str(uuid.uuid4())"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*family"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Instance's family representing type defined by creator plugin.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*creator_identifier"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Identifier of creator that collected/created the instance.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*creator_attributes"),(0,i.kt)("td",{parentName:"tr",align:null},"dict"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of attributes that are defined by the creator plugin (",(0,i.kt)("inlineCode",{parentName:"td"},"get_instance_attr_defs"),").")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"*publish_attributes"),(0,i.kt)("td",{parentName:"tr",align:null},"dict"),(0,i.kt)("td",{parentName:"tr",align:null},"Dictionary of attributes that are defined by publish plugins.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"variant"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Variant is entered by the artist on creation and may affect ",(0,i.kt)("strong",{parentName:"td"},"product"),".")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"product"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of instance. This name will be used as a product name during publishing. Can be changed on context change or variant change.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"active"),(0,i.kt)("td",{parentName:"tr",align:null},"bool"),(0,i.kt)("td",{parentName:"tr",align:null},"Is the instance active and will be published or not.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"asset"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of asset in which context was created.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"task"),(0,i.kt)("td",{parentName:"tr",align:null},"str"),(0,i.kt)("td",{parentName:"tr",align:null},"Name of task in which context was created. Can be set to ",(0,i.kt)("inlineCode",{parentName:"td"},"None"),".")))),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Task should not be required until the product name template expects it.")),(0,i.kt)("p",null,"object of ",(0,i.kt)("strong",{parentName:"p"},"CreatedInstance")," has method ",(0,i.kt)("strong",{parentName:"p"},"data_to_store")," which returns a dictionary that can be parsed to a json string. This method will return all data related to the instance so it can be re-created using ",(0,i.kt)("inlineCode",{parentName:"p"},"CreatedInstance.from_existing(data)"),"."),(0,i.kt)("h4",{id:"category-doc-link"},(0,i.kt)("em",{parentName:"h4"},"Create context")),(0,i.kt)("p",null,"Controller and wrapper around Creating is ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateContext")," which cares about loading of plugins needed for Creating. And validates required functions in host implementation."),(0,i.kt)("p",null,"Context discovers creator and publish plugins. Trigger collections of existing instances on creators and trigger Creating itself. Also it keeps in mind instance objects by their ids."),(0,i.kt)("p",null,"Creator plugins can call ",(0,i.kt)("strong",{parentName:"p"},"creator_adds_instance")," or ",(0,i.kt)("strong",{parentName:"p"},"creator_removed_instance")," to add/remove instances but these methods are not meant to be called directly out of the creator. The reason is that it is the creator's responsibility to remove metadata or decide if it should remove the instance."),(0,i.kt)("p",null,"During reset are re-cached Creator plugins, re-collected instances, refreshed host context and more. Object of ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateContext")," supply shared data during the reset. They can be used by creators to share same data needed during collection phase or during creation for autocreators."),(0,i.kt)("h4",{id:"required-functions-in-host-implementation"},"Required functions in host implementation"),(0,i.kt)("p",null,"It is recommended to use ",(0,i.kt)("inlineCode",{parentName:"p"},"HostBase")," class (",(0,i.kt)("inlineCode",{parentName:"p"},"from ayon.host import HostBase"),") as base for host implementation with combination of ",(0,i.kt)("inlineCode",{parentName:"p"},"IPublishHost")," interface (",(0,i.kt)("inlineCode",{parentName:"p"},"from ayon.host import IPublishHost"),"). These abstract classes should guide you to fill missing attributes and methods."),(0,i.kt)("p",null,"To sum them and in case host implementation is inheriting ",(0,i.kt)("inlineCode",{parentName:"p"},"HostBase")," the implementation ",(0,i.kt)("strong",{parentName:"p"},"must")," implement ",(0,i.kt)("strong",{parentName:"p"},"get_context_data")," and ",(0,i.kt)("strong",{parentName:"p"},"update_context_data"),". These two functions are needed to store metadata that are not related to any instance but are needed for Creating and publishing process. Right now only data about enabled/disabled optional publish plugins is stored there. When data is not stored and loaded properly, reset of publishing will cause that they will be set to default value. Context data also parsed to json string similarly as instance data."),(0,i.kt)("p",null,"There are also few optional functions. For UI purposes it is possible to implement ",(0,i.kt)("strong",{parentName:"p"},"get_context_title")," which can return a string shown in UI as a title. Output string may contain html tags. It is recommended to return context path (it will be created function this purposes) in this order ",(0,i.kt)("inlineCode",{parentName:"p"},'"{project name}/{asset hierarchy}/<b>{asset name}</b>/{task name}"')," (this is default implementation in ",(0,i.kt)("inlineCode",{parentName:"p"},"HostBase"),")."),(0,i.kt)("p",null,"Another optional function is ",(0,i.kt)("strong",{parentName:"p"},"get_current_context"),". This function is handy in hosts where it is possible to open multiple workfiles in one process so using global context variables is not relevant because artists can switch between opened workfiles without being acknowledged. When a function is not implemented or won't return the right keys the global context is used."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'# Expected keys in output\n{\n    "project_name": "MyProject",\n    "asset_name": "sq01_sh0010",\n    "task_name": "Modeling"\n}\n')),(0,i.kt)("h3",{id:"create-plugin"},"Create plugin"),(0,i.kt)("p",null,"Main responsibility of create plugin is to create, update, collect and remove instance metadata and propagate changes to create context. Has access to ",(0,i.kt)("strong",{parentName:"p"},"CreateContext")," (",(0,i.kt)("inlineCode",{parentName:"p"},"self.create_context"),") that discovered the plugin so has also access to other creators and instances. Create plugins have a lot of responsibility so it is recommended to implement common code per host."),(0,i.kt)("h4",{id:"basecreator"},(0,i.kt)("em",{parentName:"h4"},"BaseCreator")),(0,i.kt)("p",null,"Base implementation of creator plugin. It is not recommended to use this class as base for production plugins but rather use one of ",(0,i.kt)("strong",{parentName:"p"},"HiddenCreator"),", ",(0,i.kt)("strong",{parentName:"p"},"AutoCreator")," and ",(0,i.kt)("strong",{parentName:"p"},"Creator")," variants."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Access to shared data"),'\nFunctions to work with "Collection shared data" can be used during reset phase of ',(0,i.kt)("inlineCode",{parentName:"p"},"CreateContext"),". Creators can cache there data that are common for them. For example list of nodes in scene. Methods are implemented on ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateContext")," but their usage is primarily for Create plugins as nothing else should use it. Each creator can access ",(0,i.kt)("inlineCode",{parentName:"p"},"collection_shared_data")," attribute which is a dictionary where shared data can be stored."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Abstractions")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"family"))," (class attr) - Tells what kind of instance will be created.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'class WorkfileCreator(Creator):\n    family = "workfile"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"collect_instances"))," (method) - Collect already existing instances from the workfile and add them to create context. This method is called on initialization or reset of ",(0,i.kt)("strong",{parentName:"li"},"CreateContext"),". Each creator is responsible to find its instance metadata, convert them to ",(0,i.kt)("strong",{parentName:"li"},"CreatedInstance")," object and add them to create context (",(0,i.kt)("inlineCode",{parentName:"li"},"self._add_instance_to_context(instnace_obj)"),").")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def collect_instances(self):\n    # Using 'pipeline.list_instances' is just example how to get existing instances from scene\n    # - getting existing instances is different per host implementation\n    for instance_data in pipeline.list_instances():\n        # Process only instances that were created by this creator\n        creator_id = instance_data.get(\"creator_identifier\")\n        if creator_id == self.identifier:\n            # Create instance object from existing data\n            instance = CreatedInstance.from_existing(\n                instance_data, self\n            )\n            # Add instance to create context\n            self._add_instance_to_context(instance)\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"create"))," (method) - Create a new object of ",(0,i.kt)("strong",{parentName:"p"},"CreatedInstance")," store its metadata to the workfile and add the instance into the created context. Failed Creating should raise ",(0,i.kt)("strong",{parentName:"p"},"CreatorError")," if an error happens that artists can fix or give them some useful information. Triggers and implementation differs for ",(0,i.kt)("strong",{parentName:"p"},"Creator"),", ",(0,i.kt)("strong",{parentName:"p"},"HiddenCreator")," and ",(0,i.kt)("strong",{parentName:"p"},"AutoCreator"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"update_instances"))," (method) - Update data of instances. Receives tuple with ",(0,i.kt)("strong",{parentName:"p"},"instance")," and ",(0,i.kt)("strong",{parentName:"p"},"changes"),"."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"def update_instances(self, update_list):\n    # Loop over changed instances\n    for instance, changes in update_list:\n        # Example possible usage of 'changes' to use different node on change\n        #   of node id in instance data (MADE UP)\n        node = None\n        if \"node_id\" in changes:\n            old_value, new_value = changes[\"node_id\"]\n            if new_value is not None:\n                node = pipeline.get_node_by_id(new_value)\n\n        if node is None:\n            node = pipeline.get_node_by_instance_id(instance.id)\n        # Get node in scene that represents the instance\n        # Imprind data to a node\n        pipeline.imprint(node, instance.data_to_store())\n\n\n# Most implementations will probably ignore 'changes' completely\ndef update_instances(self, update_list):\n    for instance, _ in update_list:\n        # Get node from scene\n        node = pipeline.get_node_by_instance_id(instance.id)\n        # Imprint data to node\n        pipeline.imprint(node, instance.data_to_store())\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"remove_instances"))," (method) - Remove instance metadata from workfile and from create context.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"# Possible way how to remove instance\ndef remove_instances(self, instances):\n    for instance in instances:\n        # Remove instance metadata from workflle\n        pipeline.remove_instance(instance.id)\n        # Remove instance from create context\n        self._remove_instance_from_context(instance)\n\n\n# Default implementation of `AutoCreator`\ndef remove_instances(self, instances):\n    pass\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"When host implementation use universal way how to store and load instances you should implement host specific creator plugin base class with implemented ",(0,i.kt)("strong",{parentName:"p"},"collect_instances"),", ",(0,i.kt)("strong",{parentName:"p"},"update_instances")," and ",(0,i.kt)("strong",{parentName:"p"},"remove_instances"),".")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Optional implementations")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"enabled"))," (attr) - Boolean if the creator plugin is enabled and used."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"identifier"))," (class attr) - Consistent unique string identifier of the creator plugin. Is used to identify source plugin of existing instances. There can't be 2 creator plugins with the same identifier. Default implementation returns ",(0,i.kt)("inlineCode",{parentName:"li"},"family")," attribute.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'class RenderLayerCreator(Creator):\n    family = "render"\n    identifier = "render_layer"\n\n\nclass RenderPassCreator(Creator):\n    family = "render"\n    identifier = "render_pass"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"label"))," (attr) - String label of creator plugin which will show up in UI, ",(0,i.kt)("inlineCode",{parentName:"li"},"identifier")," is used when not set. It should be possible to use html tags.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'class RenderLayerCreator(Creator):\n    label = "Render Layer"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_icon"))," (attr) - Icon of creator and its instances. Value can be a path to an image file, full name of qtawesome icon, ",(0,i.kt)("inlineCode",{parentName:"li"},"QPixmap")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"QIcon"),". For complex cases or cases when ",(0,i.kt)("inlineCode",{parentName:"li"},"Qt")," objects are returned it is recommended to override ",(0,i.kt)("inlineCode",{parentName:"li"},"get_icon")," method and handle the logic or import ",(0,i.kt)("inlineCode",{parentName:"li"},"Qt")," inside the method to not break headless usage of creator plugin. For list of qtawesome icons check qtawesome github repository (look for the used version in pyproject.toml). Default implementation return ",(0,i.kt)("strong",{parentName:"li"},"icon")," attribute."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"icon"))," (method) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"li"},"get_icon"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'class RenderLayerCreator(Creator):\n    # Use font awesome 5 icon\n    icon = "fa5.building"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_instance_attr_defs"))," (method) - Attribute definitions of instance. Creator can define attribute values with default values for each instance. These attributes may affect how instances will be instance processed during publishing. Attribute defiitions can be used from ",(0,i.kt)("inlineCode",{parentName:"li"},"ayon.lib.attribute_definitions"),". Attribute definitions define basic types of values for different cases e.g. boolean, number, string, enumerator, etc. Default implementation returns ",(0,i.kt)("strong",{parentName:"li"},"instance_attr_defs"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"instance_attr_defs"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"li"},"get_instance_attr_defs"),".")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'from ayon.lib import attribute_definitions\n\n\nclass RenderLayerCreator(Creator):\n    def get_instance_attr_defs(self):\n        # Return empty list if \'_allow_farm_render\' is not enabled (can be set during initialization)\n        if not self._allow_farm_render:\n            return []\n        # Give artist option to change if should be rendered on farm or locally\n        return [\n            attribute_definitions.BoolDef(\n                "render_farm",\n                default=False,\n                label="Render on Farm"\n            )\n        ]\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_product_name"))," (method) - Calculate product name based on passed data. Data can be extended using the ",(0,i.kt)("inlineCode",{parentName:"p"},"get_dynamic_data")," method. Default implementation is using ",(0,i.kt)("inlineCode",{parentName:"p"},"get_product_name")," from ",(0,i.kt)("inlineCode",{parentName:"p"},"ayon.lib")," which is recommended.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_dynamic_data"))," (method) - Can be used to extend data for product templates which may be required in some cases."))),(0,i.kt)("p",null,"Methods are used before instance creation and on instance product name update. Update may require to have access to existing instance because dynamic data should be filled from there. Because of that is instance passed to ",(0,i.kt)("inlineCode",{parentName:"p"},"get_product_name")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"get_dynamic_data")," so the creator can handle that cases."),(0,i.kt)("p",null,"This is one example where product name template may contain ",(0,i.kt)("inlineCode",{parentName:"p"},'"{layer}"')," which is filled during creation because the value is taken from selection. In that case ",(0,i.kt)("inlineCode",{parentName:"p"},"get_dynamic_data")," returns value for ",(0,i.kt)("inlineCode",{parentName:"p"},'"layer"')," -> ",(0,i.kt)("inlineCode",{parentName:"p"},'"{layer}"')," so it can be filled in creation. But when product name of already existing instance is updated it should return already existing value. Note: Creator must make sure the value is available on instance."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'from ayon.lib import prepare_template_data\nfrom my_host import get_selected_layer\n\n\nclass SomeCreator(Creator):\n    def get_dynamic_data(\n        self, variant, task_name, asset_doc, project_name, host_name, instance\n    ):\n        # Before instance is created return unfilled key\n        # - the key will be filled during creation\n        if instance is None:\n            return {"layer": "{layer}"}\n        # Take value from existing instance\n        # - creator must know where to look for the value\n        return {"layer": instance.data["layer"]}\n\n    def create(self, product_name, instance_data, pre_create_data):\n        # Fill the layer name in\n        layer = get_selected_layer()\n        layer_name = layer["name"]\n        layer_fill_data = prepare_template_data({"layer": layer_name})\n        product_name = product_name.format(**layer_fill_data)\n        instance_data["layer"] = layer_name\n        ...\n')),(0,i.kt)("h4",{id:"hiddencreator"},(0,i.kt)("em",{parentName:"h4"},"HiddenCreator")),(0,i.kt)("p",null,"Creator which is not showed in UI so artist can't trigger it directly but is available for other creators. This creator is primarily meant for cases when creation should create different types of instances. For example during editorial publishing where input is single edl file but should create 2 or more kind of instances each with different family, attributes and abilities. Arguments for creation were limited to ",(0,i.kt)("inlineCode",{parentName:"p"},"instance_data")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"source_data"),". Data of ",(0,i.kt)("inlineCode",{parentName:"p"},"instance_data")," should follow what is sent to other creators and ",(0,i.kt)("inlineCode",{parentName:"p"},"source_data")," can be used to send custom data defined by main creator. It is expected that ",(0,i.kt)("inlineCode",{parentName:"p"},"HiddenCreator"),' has specific main or "parent" creator.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def create(self, instance_data, source_data):\n    variant = instance_data["variant"]\n    task_name = instance_data["task"]\n    asset_name = instance_data["asset"]\n    asset_doc = get_asset_by_name(self.project_name, asset_name)\n    self.get_product_name(\n        variant, task_name, asset_doc, self.project_name, self.host_name)\n')),(0,i.kt)("h4",{id:"autocreator"},(0,i.kt)("em",{parentName:"h4"},"AutoCreator")),(0,i.kt)("p",null,"Creator that is triggered on reset of create context. Can be used for families that are expected to be created automatically without artist interaction (e.g. ",(0,i.kt)("strong",{parentName:"p"},"workfile"),"). Method ",(0,i.kt)("inlineCode",{parentName:"p"},"create")," is triggered after collecting all creators."),(0,i.kt)("admonition",{type:"important"},(0,i.kt)("p",{parentName:"admonition"},(0,i.kt)("strong",{parentName:"p"},"AutoCreator")," has implemented ",(0,i.kt)("strong",{parentName:"p"},"remove_instances")," to do nothing as removing of auto created instances would lead to creating new instance immediately or on refresh.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def __init__(\n    self, create_context, system_settings, project_settings, *args, **kwargs\n):\n    super(MyCreator, self).__init__(\n        create_context, system_settings, project_settings, *args, **kwargs\n    )\n    # Get variant value from settings\n    variant_name = (\n        project_settings["my_host"][self.identifier]["variant"]\n    ).strip()\n    if not variant_name:\n        variant_name = "Main"\n    self._variant_name = variant_name\n\n# Create does not expect any arguments\ndef create(self):\n    # Look for existing instance in create  context\n    existing_instance = None\n    for instance in self.create_context.instances:\n        if instance.creator_identifier == self.identifier:\n            existing_instance = instance\n            break\n\n    # Collect current context information\n    # - variant can be filled from settings\n    variant = self._variant_name\n    # Only place where we can look for current context\n    project_name = self.project_name\n    asset_name = legacy_io.Session["AVALON_ASSET"]\n    task_name = legacy_io.Session["AVALON_TASK"]\n    host_name = legacy_io.Session["AVALON_APP"]\n\n    # Create new instance if does not exist yet\n    if existing_instance is None:\n        asset_doc = get_asset_by_name(project_name, asset_name)\n        product_name = self.get_product_name(\n            variant, task_name, asset_doc, project_name, host_name\n        )\n        data = {\n            "asset": asset_name,\n            "task": task_name,\n            "variant": variant\n        }\n        data.update(self.get_dynamic_data(\n            variant, task_name, asset_doc, project_name, host_name\n        ))\n\n        new_instance = CreatedInstance(\n            self.family, product_name, data, self\n        )\n        self._add_instance_to_context(new_instance)\n\n    # Update instance context if is not the same\n    elif (\n        existing_instance["asset"] != asset_name\n        or existing_instance["task"] != task_name\n    ):\n        asset_doc = get_asset_by_name(project_name, asset_name)\n        product_name = self.get_product_name(\n            variant, task_name, asset_doc, project_name, host_name\n        )\n        existing_instance["asset"] = asset_name\n        existing_instance["task"] = task_name\n')),(0,i.kt)("h4",{id:"creator"},(0,i.kt)("em",{parentName:"h4"},"Creator")),(0,i.kt)("p",null,"Implementation of creator plugin that is triggered manually by the artist in UI (or by code). Has extended options for UI purposes than ",(0,i.kt)("strong",{parentName:"p"},"AutoCreator")," and ",(0,i.kt)("strong",{parentName:"p"},"create")," method expect more arguments."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Optional implementations")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"create_allow_context_change"))," (class attr) - Allow to set context in UI before Creating. Some creators may not allow it or their logic would not use the context selection (e.g. bulk creators). Is set to ",(0,i.kt)("inlineCode",{parentName:"li"},"True")," but default.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"class BulkRenderCreator(Creator):\n    create_allow_context_change = False\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_default_variants"))," (method) - Returns list of default variants that are listed in create dialog for user. Returns ",(0,i.kt)("strong",{parentName:"p"},"default_variants")," attribute by default.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"default_variants"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"p"},"get_default_variants"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_default_variant"))," (method) - Returns default variant that is prefilled in UI (value does not have to be in default variants). By default returns ",(0,i.kt)("strong",{parentName:"p"},"default_variant")," attribute. If returns ",(0,i.kt)("inlineCode",{parentName:"p"},"None")," then UI logic will take first item from ",(0,i.kt)("strong",{parentName:"p"},"get_default_variants")," if there is any otherwise ",(0,i.kt)("strong",{parentName:"p"},'"Main"')," is used.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"default_variant"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"p"},"get_default_variant"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_description"))," (method) - Returns a short string description of the creator. Returns ",(0,i.kt)("strong",{parentName:"p"},"description")," attribute by default.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"description"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"p"},"get_description"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_detailed_description"))," (method) - Returns detailed string description of creator. Can contain markdown. Returns ",(0,i.kt)("strong",{parentName:"p"},"detailed_description")," attribute by default.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"detailed_description"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"p"},"get_detailed_description"),".")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"get_pre_create_attr_defs"))," (method) - Similar to ",(0,i.kt)("strong",{parentName:"p"},"get_instance_attr_defs")," returns attribute definitions but they are filled before creation. When creation is called from UI the values are passed to ",(0,i.kt)("strong",{parentName:"p"},"create")," method. Returns ",(0,i.kt)("strong",{parentName:"p"},"pre_create_attr_defs")," attribute by default.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"pre_create_attr_defs"))," (attr) - Attribute for default implementation of ",(0,i.kt)("strong",{parentName:"p"},"get_pre_create_attr_defs"),"."))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'from ayon.lib import attribute_definitions\nfrom ayon.pipeline.create import Creator\n\n\nclass CreateRender(Creator):\n    family = "render"\n    label = "Render"\n    icon = "fa.eye"\n    description = "Render scene viewport"\n\n    def __init__(\n        self, context, system_settings, project_settings, *args, **kwargs\n    ):\n        super(CreateRender, self).__init__(\n            context, system_settings, project_settings, *args, **kwargs\n        )\n        plugin_settings = (\n            project_settings["my_host"]["create"][self.__class__.__name__]\n        )\n        # Get information if studio has enabled farm publishing\n        self._allow_farm_render = plugin_settings["allow_farm_render"]\n        # Get default variants from settings\n        self.default_variants = plugin_settings["variants"]\n\n    def get_instance_attr_defs(self):\n        # Return empty list if \'_allow_farm_render\' is not enabled (can be set during initialization)\n        if not self._allow_farm_render:\n            return []\n        # Give artist option to change if should be rendered on farm or locally\n        return [\n            attribute_definitions.BoolDef(\n                "render_farm",\n                default=False,\n                label="Render on Farm"\n            )\n        ]\n\n    def get_pre_create_attr_defs(self):\n        # Give user option to use selection or not\n        attrs = [\n            attribute_definitions.BoolDef(\n                "use_selection",\n                default=False,\n                label="Use selection"\n            )\n        ]\n        if self._allow_farm_render:\n            # Set to render on farm in creator dialog\n            # - this value is not automatically passed to instance attributes\n            #   creator must do that during creation\n            attrs.append(\n                attribute_definitions.BoolDef(\n                    "render_farm",\n                    default=False,\n                    label="Render on Farm"\n                )\n            )\n        return attrs\n\n    def create(self, product_name, instance_data, pre_create_data):\n        # ARGS:\n        # - \'product_name\' - precalculated product name\n        # - \'instance_data\' - context data\n        #    - \'asset\' - asset name\n        #    - \'task\' - task name\n        #    - \'variant\' - variant\n        #    - \'family\' - instance family\n\n        # Check if should use selection or not\n        if pre_create_data.get("use_selection"):\n            items = pipeline.get_selection()\n        else:\n            items = [pipeline.create_write()]\n\n        # Validations related to selection\n        if len(items) > 1:\n            raise CreatorError("Please select only single item at time.")\n\n        elif not items:\n            raise CreatorError("Nothing to create. Select at least one item.")\n\n        # Create instence object\n        new_instance = CreatedInstance(self.family, product_name, data, self)\n        # Pass value from pre create attribute to instance\n        # - use them only when pre create date contain the data\n        if "render_farm" in pre_create_data:\n            use_farm = pre_create_data["render_farm"]\n            new_instance.creator_attributes["render_farm"] = use_farm\n\n        # Store metadata to workfile\n        pipeline.imprint(new_instance.id, new_instance.data_to_store())\n\n        # Add instance to context\n        self._add_instance_to_context(new_instance)\n')),(0,i.kt)("h2",{id:"publish"},(0,i.kt)("strong",{parentName:"h2"},"Publish")),(0,i.kt)("h3",{id:"exceptions"},"Exceptions"),(0,i.kt)("p",null,"AYON define few specific exceptions that should be used in publish plugins."),(0,i.kt)("h4",{id:"validation-exception"},(0,i.kt)("em",{parentName:"h4"},"Validation exception")),(0,i.kt)("p",null,"Validation plugins should raise ",(0,i.kt)("inlineCode",{parentName:"p"},"PublishValidationError")," to show to an artist what's wrong and give him actions to fix it. The exception says that errors in the plugin can be fixed by the artist himself (with or without action on plugin). Any other errors will stop publishing immediately. The exception ",(0,i.kt)("inlineCode",{parentName:"p"},"PublishValidationError")," raised after validation order has the same effect as any other exception."),(0,i.kt)("p",null,"Exception ",(0,i.kt)("inlineCode",{parentName:"p"},"PublishValidationError")," expects 4 arguments:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"message")," Which is not used in UI but for headless publishing."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"title")," Short description of error (2-5 words). Title is used for grouping of exceptions per plugin."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"description")," Detailed description of the issue where markdown and html can be used."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"detail")," Is optional to give even more detailed information for advanced users. At this moment the detail is shown directly under description but it is in plan to have detail in a collapsible widget.")),(0,i.kt)("p",null,"Extended version is ",(0,i.kt)("inlineCode",{parentName:"p"},"PublishXmlValidationError")," which uses xml files with stored descriptions. This helps to avoid having huge markdown texts inside code. The exception has 4 arguments:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"plugin")," The plugin object which raises the exception to find its related xml file."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"message")," Exception message for publishing without UI or different pyblish UI."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"key")," Optional argument says which error from xml is used as a validation plugin may raise error with different messages based on the current errors. Default is ",(0,i.kt)("strong",{parentName:"li"},'"main"'),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"formatting_data")," Optional dictionary to format data in the error. This is used to fill detailed description with data from the publishing so artist can get more precise information.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Where and how to create xml file")),(0,i.kt)("p",null,"Xml files for ",(0,i.kt)("inlineCode",{parentName:"p"},"PublishXmlValidationError")," must be located in ",(0,i.kt)("strong",{parentName:"p"},"./help")," subfolder next to the plugin and the filename must match the filename of the plugin."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# File location related to plugin file\n\u2514 publish\n \u251c help\n \u2502 \u251c validate_scene.xml\n \u2502 \u2514 ...\n \u251c validate_scene.py\n \u2514 ...\n")),(0,i.kt)("p",null,"Xml file content has ",(0,i.kt)("strong",{parentName:"p"},"<","root",">")," node which may contain any amount of ",(0,i.kt)("strong",{parentName:"p"},"<","error",">")," nodes, but each of them must have ",(0,i.kt)("strong",{parentName:"p"},"id")," attribute with unique value. That is then used for ",(0,i.kt)("strong",{parentName:"p"},"key"),". Each error must have ",(0,i.kt)("strong",{parentName:"p"},"<","title",">")," and ",(0,i.kt)("strong",{parentName:"p"},"<","description",">")," and ",(0,i.kt)("strong",{parentName:"p"},"<","detail",">"),". Text content may contain python formatting keys that can be filled when an exception is raised."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8"?>\n<root>\n    <error id="main">\n        <title>Product context</title>\n        <description>## Invalid product context\n\nContext of the given product doesn\'t match your current scene.\n\n### How to repair?\n\nYou can fix this with the "Repair" button on the right. This will use \'{expected_asset}\' asset name and overwrite \'{found_asset}\' asset name in scene metadata.\n\nAfter that restart publishing with Reload button.\n        </description>\n        <detail>\n### How could this happen?\n\nThe product was created in different scene with different context\nor the scene file was copy pasted from different context.\n        </detail>\n    </error>\n</root>\n')),(0,i.kt)("h4",{id:"known-errors"},(0,i.kt)("em",{parentName:"h4"},"Known errors")),(0,i.kt)("p",null,"When there is a known error that can't be fixed by the user (e.g. can't connect to deadline service, etc.) ",(0,i.kt)("inlineCode",{parentName:"p"},"KnownPublishError")," should be raised. The only difference is that its message is shown in UI to the artist otherwise a neutral message without context is shown."),(0,i.kt)("h3",{id:"plugin-extension"},"Plugin extension"),(0,i.kt)("p",null,"Publish plugins can be extended by additional logic when inheriting from ",(0,i.kt)("inlineCode",{parentName:"p"},"OpenPypePyblishPluginMixin")," which can be used as mixin (additional inheritance of class). Publish plugins that inherit from this mixin can define attributes that will be shown in ",(0,i.kt)("strong",{parentName:"p"},"CreatedInstance"),". One of the most important usages is to be able turn on/off optional plugins."),(0,i.kt)("p",null,"Attributes are defined by the return value of ",(0,i.kt)("inlineCode",{parentName:"p"},"get_attribute_defs")," method. Attribute definitions are for families defined in plugin's ",(0,i.kt)("inlineCode",{parentName:"p"},"families")," attribute if it's instance plugin or for whole context if it's context plugin. To convert existing values (or to remove legacy values) can be re-implemented ",(0,i.kt)("inlineCode",{parentName:"p"},"convert_attribute_values"),". Default implementation just converts the values to right types."),(0,i.kt)("p",null,":::Important\nValues of publish attributes from created instance are never removed automatically so implementing this method is the best way to remove legacy data or convert them to new data structure.\n:::"),(0,i.kt)("p",null,"Possible attribute definitions can be found in ",(0,i.kt)("inlineCode",{parentName:"p"},"ayon/pipeline/lib/attribute_definitions.py"),"."),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Example plugin"),(0,i.kt)("p",null,(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},"import pyblish.api\nfrom ayon.lib import attribute_definitions\nfrom ayon.pipeline import OpenPypePyblishPluginMixin\n\n\n# Example context plugin\nclass MyExtendedPlugin(\n    pyblish.api.ContextPlugin, OpenPypePyblishPluginMixin\n):\n    optional = True\n    active = True\n\n    @classmethod\n    def get_attribute_defs(cls):\n        return [\n            attribute_definitions.BoolDef(\n                # Key under which it will be stored\n                \"process\",\n                # Use 'active' as default value\n                default=cls.active,\n                # Use plugin label as label for attribute\n                label=cls.label\n            )\n        ]\n\n    def process_plugin(self, context):\n        # First check if plugin is optional\n        if not self.optional:\n            return True\n\n        # Attribute values are stored by class names\n        # - for those purposes was implemented 'get_attr_values_from_data'\n        #   to help with accessing it\n        attribute_values = self.get_attr_values_from_data(context.data)\n        # Get 'process' key\n        process_value = attribute_values.get(\"process\")\n        if process_value is None or process_value:\n            return True\n        return False\n\n    def process(self, context):\n        if not self.process_plugin(context):\n            return\n        # Do plugin logic\n        ...\n")))),(0,i.kt)("h2",{id:"ui-examples"},(0,i.kt)("strong",{parentName:"h2"},"UI examples")),(0,i.kt)("h3",{id:"main-publish-window"},"Main publish window"),(0,i.kt)("p",null,"Main window of publisher shows instances and their values, collected by creators."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Card view"),"\n",(0,i.kt)("img",{alt:"Publisher UI - Card view",src:n(969).Z,width:"1002",height:"631"}),"\n",(0,i.kt)("strong",{parentName:"p"},"List view"),"\n",(0,i.kt)("img",{alt:"Publisher UI - List view",src:n(2134).Z,width:"1003",height:"631"})),(0,i.kt)("h4",{id:"instances-views"},(0,i.kt)("em",{parentName:"h4"},"Instances views")),(0,i.kt)("p",null,"List of instances always contains an ",(0,i.kt)("inlineCode",{parentName:"p"},"Options")," item which is used to show attributes of context plugins. Values from the item are saved and loaded using ",(0,i.kt)("a",{parentName:"p",href:"#required-functions-in-host-implementation"},"host implementation")," ",(0,i.kt)("strong",{parentName:"p"},"get_context_data")," and ",(0,i.kt)("strong",{parentName:"p"},"update_context_data"),". Instances are grouped by family and can be shown in card view (single selection) or list view (multi selection)."),(0,i.kt)("p",null,"Instance view has at the bottom 3 buttons. Plus sign opens ",(0,i.kt)("a",{parentName:"p",href:"#create-dialog"},"create dialog"),", bin removes selected instances and stripes swap card and list view."),(0,i.kt)("h4",{id:"context-options"},(0,i.kt)("em",{parentName:"h4"},"Context options")),(0,i.kt)("p",null,"It is possible to change variant or asset and task context of instances at the top part but all changes there must be confirmed. Confirmation will trigger recalculation of product names and all new data are stored to instances."),(0,i.kt)("h4",{id:"create-attributes"},(0,i.kt)("em",{parentName:"h4"},"Create attributes")),(0,i.kt)("p",null,"Instance attributes display all created attributes of all selected instances. All attributes that have the same definition are grouped into one input and are visually indicated if values are not the same for selected instances. In most cases have ",(0,i.kt)("strong",{parentName:"p"},"< Multiselection >")," placeholder."),(0,i.kt)("h4",{id:"publish-attributes"},(0,i.kt)("em",{parentName:"h4"},"Publish attributes")),(0,i.kt)("p",null,"Publish attributes work the same way as create attributes but the source of attribute definitions are pyblish plugins. Attributes are filtered based on families of selected instances and families defined in the pyblish plugin."),(0,i.kt)("h3",{id:"create-dialog"},"Create dialog"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Publisher UI - Create dialog",src:n(303).Z,width:"898",height:"526"}),"\nCreate dialog is used by artist to create new instances in a context. The context selection can be enabled/disabled by changing ",(0,i.kt)("inlineCode",{parentName:"p"},"create_allow_context_change")," on ",(0,i.kt)("a",{parentName:"p",href:"#creator"},"creator plugin"),". In the middle part the artist selects what will be created and what variant it is. On the right side is information about the selected creator and its pre-create attributes. There is also a question mark button which extends the window and displays more detailed information about the creator."))}m.isMDXComponent=!0},969:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/publisher_card_view-64dcd258f4ccfe6ed883843070d608a9.png"},303:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/publisher_create_dialog-5fc037f9794e41e2f843e6b702365ceb.png"},2134:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/publisher_list_view-6f823be473cc45353ccde35a0a3c0cda.png"}}]);